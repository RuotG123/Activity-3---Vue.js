<!--
  Name: Ruot Gal
  Class: ISQA 4900 – Full Stack Application Development
  Date: September 2025
  Activity 3 – Display, Search, and Filter Data with Vue
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Alumni Search and Filter</title>
  <script src="https://unpkg.com/vue@3"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f9f9f9; }
    h1 { text-align: center; }
    .filters { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
    label { font-size: 14px; }
    input, select { padding: 6px; width: 100%; }
    table { border-collapse: collapse; width: 100%; background: #fff; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background: #eee; }
    tr:nth-child(even) { background: #f5f5f5; }
  </style>
</head>
<body>
  <div id="app">
    <h1>University Alumni Directory</h1>

    <!-- Filter Form -->
    <div class="filters">
      <label>Student ID <input v-model="q.student_id" placeholder="e.g. 101"></label>
      <label>First Name <input v-model="q.first_name" placeholder="e.g. James"></label>
      <label>Last Name <input v-model="q.last_name" placeholder="e.g. Butler"></label>
      <label>Address <input v-model="q.address" placeholder="Street"></label>
      <label>City <input v-model="q.city" placeholder="City"></label>
      <label>State <input v-model="q.state" placeholder="State"></label>
      <label>Zip Code <input v-model="q.zip" placeholder="Zip"></label>
      <label>Donor
        <select v-model="q.donor">
          <option value="">(Any)</option>
          <option value="true">Yes</option>
          <option value="false">No</option>
        </select>
      </label>
    </div>

    <p>Showing {{ filtered.length }} of {{ alumni.length }} records</p>

    <!-- Table Display -->
    <table v-if="filtered.length > 0">
      <thead>
        <tr>
          <th>ID</th>
          <th>First</th>
          <th>Last</th>
          <th>Address</th>
          <th>City</th>
          <th>State</th>
          <th>Zip</th>
          <th>Donor</th>
        </tr>
      </thead>
      <tbody>
        <tr v-for="person in filtered" :key="person.student_id">
          <td>{{ person.student_id }}</td>
          <td>{{ person.first_name }}</td>
          <td>{{ person.last_name }}</td>
          <td>{{ person.address }}</td>
          <td>{{ person.city }}</td>
          <td>{{ person.state }}</td>
          <td>{{ person.zip }}</td>
          <td>{{ donorStatus(person.donor) }}</td>
        </tr>
      </tbody>
    </table>

    <div v-else>
      <p>No records found. Try adjusting your filters.</p>
    </div>
  </div>

  <script>
    const { createApp } = Vue;

    createApp({
      data() {
        return {
          alumni: [],
          q: { student_id: "", first_name: "", last_name: "", address: "",
               city: "", state: "", zip: "", donor: "" }
        };
      },
      computed: {
        filtered() {
          return this.alumni.filter(p => {
            const match = (field, value) => {
              if (!value) return true;
              return String(p[field]).toLowerCase().includes(value.toLowerCase());
            };
            const idOk    = match("student_id", this.q.student_id);
            const firstOk = match("first_name", this.q.first_name);
            const lastOk  = match("last_name", this.q.last_name);
            const addrOk  = match("address", this.q.address);
            const cityOk  = match("city", this.q.city);
            const stateOk = match("state", this.q.state);
            const zipOk   = match("zip", this.q.zip);

            let donorOk = true;
            if (this.q.donor !== "") {
              donorOk = String(p.donor) === this.q.donor;
            }
            return idOk && firstOk && lastOk && addrOk && cityOk && stateOk && zipOk && donorOk;
          });
        }
      },
      methods: {
        donorStatus(val) { return val ? "Yes" : "No"; }
      },
      mounted() {
        fetch("alumni.json")
          .then(r => r.json())
          .then(data => { this.alumni = data; })
          .catch(err => console.error("Error loading JSON", err));
      }
    }).mount("#app");
  </script>
</body>
</html>
